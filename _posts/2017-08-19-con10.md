---
layout:     post
title:      "sc2017新初三%你赛10总结"
subtitle:   "只有能力提高了，才能永远立于不败之地"
date:       2017-08-19 19:53:26
author:     "Kaibin-Lu"
header-img: "img/sc_con10res.png"
mathjax:    true
tags:
    - 比赛总结
---


这次比赛，感觉发挥得不算好也不算差。没有大的失误，但是明明没有特别难的题，却没有 AK。  

初看 [T1](https://kaibin-lu.github.io/2017/08/19/smoj2225/) 的时候是懵的，不知道题目讲的那么多是什么意思。于是先去看 [T2](https://kaibin-lu.github.io/2017/08/22/smoj2226/)，发现是双标记的线段树，有点慌。  
这东西之前是有听说过，大致记得应该怎么实现。但是**“大致”恰恰是 OI 竞赛中最要命的**。**没有精准，就没有稳定可言**。  
不管怎么说，先打了个 $O(n^2)$ 的暴力，还可以留着对拍用。看 $delta$ 都比较大，没忘开了 long long。  

在回忆起双标记的确切做法之前，我决定先回去看清楚 T1。  
结合样例分析了一下题意之后，想到对于每个结点，暴力合并它的子结点信息在一个数组里，sort 之后直接搞，可以 $O(n^2\log n)$ 水 30 分。  
先把暴力写完，交了上去。正准备思考正解的时候，不经意瞄了一眼暴力代码，突然意识到，这个合并操作的目的是维护有序的序列。  
这不就是昨天 lgj 讲的启发式合并？但我还是有点担心被冲昏头脑，写了大半才又发现理论有问题，于是细细分析了一下。  
最终得出的结论，这完全就是启发式合并。确定了之后就不再犹豫，马上开始写。  
由于昨天下午才讲，自己没有及时找资料跟进学习，也没看过模板，对一些操作不是很熟悉。（其实主要就是合并部分，从小的拿出来再插到大的里面）  

写好了跟暴力对拍一下，出问题了。这才 $n<10$ 的极小数据。
单步跟踪，发现在合并的地方，Treap 的根没有改变。实在想不通，一出函数为什么就变回原样了。突然发现，指针**传参数的时候没加引用**。  
吓得我赶紧改了过来，再对拍还是不行。重新单步跟踪，这次发现是因为，我把值相同的结点压在了一起，合并时候的插入却没把 `sum` 乘上 `cnt`。  
这又是一个弱智的错误，浪费了几分钟。改过来之后对拍倒是没问题了，想试试极限数据表现如何。  
随便构造了一组 $n=10^5$ 的数据，结果一运行就炸了。第一反应就是数组没开够，再开大一倍，还是炸。  
我心想，总不会要开四倍吧。到这里我已经不认为是数组开小的问题了，但还是抱着试一试的心态，开了四倍，结果就没炸了。  
这就非常尴尬了，不是说空间复杂度是 $O(n\log n)$ 的么？但反正也不会 MLE，所以还是就这样交上去了。事后想想，这里应该写成动态分配会更好。  

此时大概还剩 1.5h，只好去推 T2。因为不记得是应该先乘再加还是先加再乘了，我只好在草稿纸上模拟了一些情况。
结果到最后还是没得出一个肯定的结论，只好随便选一种写了。数据结构最近一直都在写 Treap，线段树反倒有些生疏了。过了样例，开始对拍。  
不愉快的事情发生了，一开始对拍就出问题了。怀疑是标记的下传可能出现了重复，于是加了个辅助判断的标记。（其实没必要，太久没写实在忘记了）  
但也还是不对，只能单步调试。数据结构这种东西，对着看是非常恐怖的，还要手动验算每个地方有没有出问题，因此尽管是小数据，仍然调得很辛苦。  
在比赛结束前，果然还是没调出来。吸取了测试九的前车之鉴，这个线段树虽然也许不会超时，但肯定会 WA，因此我的 T2 有且仅有一次提交，就是暴力。  

最后出来成绩 97 + 40 = 107，居然还有 rank4。听着一堆 dalao 们在比赛结束前早早地谈笑风生，我还以为个个都 AK 了呢。
T2 与预料完全一致，但 T1 被卡了一个点就不科学了。后来发现，把静态分配的内存池改成动态地 `new` 和 `delete` 就能 A 了，而且耗内存小了很多。  
总的来说，这次两道都是经典题，但是第二题做得不好，比较长时间没有打线段树，对区间修改的双标记没有进行了解，赛场上再要重新来推就会比较麻烦。  
就像 lgj 说的那样，数据结构是“工具”，是通过对数据的高效组织和处理，从而加快我们的计算。如果连“工具”的“使用方式”都掌握不了，又怎么能够很好地利用工具来使自己的工作变得高效呢？这种题就不像平时练的其他思维题，这完全是有规律可循的，只要勤奋，就不难掌握。这一点，我做得还不够好。
